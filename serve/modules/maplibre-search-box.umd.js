(function(c,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(c=typeof globalThis<"u"?globalThis:c||self,d(c.maplibreSearchBox={}))})(this,function(c){"use strict";var nt=Object.defineProperty;var tt=(c,d,v)=>d in c?nt(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v;var i=(c,d,v)=>tt(c,typeof d!="symbol"?d+"":d,v);const d="https://api.stadiamaps.com".replace(/\/+$/,"");class v{constructor(o={}){this.configuration=o}set config(o){this.configuration=o}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:d}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||L}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const o=this.configuration.apiKey;if(o)return typeof o=="function"?o:()=>o}get accessToken(){const o=this.configuration.accessToken;if(o)return typeof o=="function"?o:async()=>o}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const P=new v,q=class I{constructor(o=P){this.configuration=o,this.fetchApi=async(t,e)=>{let a={url:t,init:e};for(const s of this.middleware)s.pre&&(a=await s.pre({fetch:this.fetchApi,...a})||a);let r;try{r=await(this.configuration.fetchApi||fetch)(a.url,a.init)}catch(s){for(const u of this.middleware)u.onError&&(r=await u.onError({fetch:this.fetchApi,url:a.url,init:a.init,error:s,response:r?r.clone():void 0})||r);if(r===void 0)throw s instanceof Error?new j(s,"The request failed and the interceptors did not return an alternative response"):s}for(const s of this.middleware)s.post&&(r=await s.post({fetch:this.fetchApi,url:a.url,init:a.init,response:r.clone()})||r);return r},this.middleware=o.middleware}withMiddleware(...o){const t=this.clone();return t.middleware=t.middleware.concat(...o),t}withPreMiddleware(...o){const t=o.map(e=>({pre:e}));return this.withMiddleware(...t)}withPostMiddleware(...o){const t=o.map(e=>({post:e}));return this.withMiddleware(...t)}isJsonMime(o){return o?I.jsonRegex.test(o):!1}async request(o,t){const{url:e,init:a}=await this.createFetchParams(o,t),r=await this.fetchApi(e,a);if(r&&r.status>=200&&r.status<300)return r;throw new A(r,"Response returned an error code")}async createFetchParams(o,t){let e=this.configuration.basePath+o.path;o.query!==void 0&&Object.keys(o.query).length!==0&&(e+="?"+this.configuration.queryParamsStringify(o.query));const a=Object.assign({},this.configuration.headers,o.headers);Object.keys(a).forEach(g=>a[g]===void 0?delete a[g]:{});const r=typeof t=="function"?t:async()=>t,s={method:o.method,headers:a,body:o.body,credentials:this.configuration.credentials},u={...s,...await r({init:s,context:o})};let m;Z(u.body)||u.body instanceof URLSearchParams||G(u.body)?m=u.body:this.isJsonMime(a["Content-Type"])?m=JSON.stringify(u.body):m=u.body;const f={...u,body:m};return{url:e,init:f}}clone(){const o=this.constructor,t=new o(this.configuration);return t.middleware=this.middleware.slice(),t}};q.jsonRegex=new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i");let E=q;function G(n){return typeof Blob<"u"&&n instanceof Blob}function Z(n){return typeof FormData<"u"&&n instanceof FormData}class A extends Error{constructor(o,t){super(t),this.response=o,this.name="ResponseError"}}class j extends Error{constructor(o,t){super(t),this.cause=o,this.name="FetchError"}}class p extends Error{constructor(o,t){super(t),this.field=o,this.name="RequiredError"}}const l={csv:","};function L(n,o=""){return Object.keys(n).map(t=>R(t,n[t],o)).filter(t=>t.length>0).join("&")}function R(n,o,t=""){const e=t+(t.length?`[${n}]`:n);if(o instanceof Array){const a=o.map(r=>encodeURIComponent(String(r))).join(`&${encodeURIComponent(e)}=`);return`${encodeURIComponent(e)}=${a}`}if(o instanceof Set){const a=Array.from(o);return R(n,a,t)}return o instanceof Date?`${encodeURIComponent(e)}=${encodeURIComponent(o.toISOString())}`:o instanceof Object?L(o,e):`${encodeURIComponent(e)}=${encodeURIComponent(String(o))}`}class y{constructor(o,t=e=>e){this.raw=o,this.transformer=t}async value(){return this.transformer(await this.raw.json())}}function z(n){return F(n)}function F(n,o){return n==null?n:{tel:n.tel==null?void 0:n.tel,website:n.website==null?void 0:n.website}}function D(n){return O(n)}function O(n,o){return n==null?n:{eurographicsGiscoId:n.eurographics_gisco_id==null?void 0:n.eurographics_gisco_id,faaCode:n.faa_code==null?void 0:n.faa_code,factualId:n.factual_id==null?void 0:n.factual_id,fifaId:n.fifa_id==null?void 0:n.fifa_id,fipsCode:n.fips_code==null?void 0:n.fips_code,frGovEpciCode:n.fr_gov_epci_code==null?void 0:n.fr_gov_epci_code,fraInseeCode:n.fra_insee_code==null?void 0:n.fra_insee_code,geonamesId:n.geonames_id==null?void 0:n.geonames_id,geoplanetId:n.geoplanet_id==null?void 0:n.geoplanet_id,hascId:n.hasc_id==null?void 0:n.hasc_id,iataCode:n.iata_code==null?void 0:n.iata_code,icaoCode:n.icao_code==null?void 0:n.icao_code,ituId:n.itu_id==null?void 0:n.itu_id,karmashapesId:n.karmashapes_id==null?void 0:n.karmashapes_id,naturalEarthId:n.natural_earth_id==null?void 0:n.natural_earth_id,nuts2021Id:n.nuts_2021_id==null?void 0:n.nuts_2021_id,quattroshapesId:n.quattroshapes_id==null?void 0:n.quattroshapes_id,quattroshapesPgId:n.quattroshapes_pg_id==null?void 0:n.quattroshapes_pg_id,usCensusGeoId:n.us_census_geo_id==null?void 0:n.us_census_geo_id,wikidataId:n.wikidata_id==null?void 0:n.wikidata_id,wikipediaPage:n.wikipedia_page==null?void 0:n.wikipedia_page}}function K(n){return B(n)}function B(n,o){return n==null?n:{brand:n.brand==null?void 0:n.brand,iata:n.iata==null?void 0:n.iata,icao:n.icao==null?void 0:n.icao,openingHours:n.opening_hours==null?void 0:n.opening_hours,operator:n.operator==null?void 0:n.operator,phone:n.phone==null?void 0:n.phone,website:n.website==null?void 0:n.website,wheelchair:n.wheelchair==null?void 0:n.wheelchair,wikidata:n.wikidata==null?void 0:n.wikidata,wikipedia:n.wikipedia==null?void 0:n.wikipedia}}function N(n){return V(n)}function V(n,o){return n==null?n:{featureCode:n.feature_code}}function H(n){return $(n)}function $(n,o){return n==null?n:{foursquare:n.foursquare==null?void 0:z(n.foursquare),geonames:n.geonames==null?void 0:N(n.geonames),osm:n.osm==null?void 0:K(n.osm),whosonfirstConcordances:n.whosonfirst_concordances==null?void 0:D(n.whosonfirst_concordances)}}function U(n){return J(n)}function J(n,o){return n==null?n:{crossStreet:n.cross_street==null?void 0:n.cross_street,number:n.number==null?void 0:n.number,postalCode:n.postal_code==null?void 0:n.postal_code,street:n.street==null?void 0:n.street,unit:n.unit==null?void 0:n.unit}}function C(n){return n}function T(n){return n}function W(n){return"text"in n}function X(n){return Q(n,!1)}function Q(n,o=!1){return n==null?n:{text:n.text,"focus.point.lat":n.focusPointLat,"focus.point.lon":n.focusPointLon,"boundary.rect.min_lat":n.boundaryRectMinLat,"boundary.rect.max_lat":n.boundaryRectMaxLat,"boundary.rect.min_lon":n.boundaryRectMinLon,"boundary.rect.max_lon":n.boundaryRectMaxLon,"boundary.circle.lat":n.boundaryCircleLat,"boundary.circle.lon":n.boundaryCircleLon,"boundary.circle.radius":n.boundaryCircleRadius,"boundary.country":n.boundaryCountry,"boundary.gid":n.boundaryGid,layers:n.layers==null?void 0:n.layers.map(T),sources:n.sources==null?void 0:n.sources.map(C),size:n.size,lang:n.lang}}function Y(n){return nn(n,!1)}function nn(n,o=!1){return n==null?n:{address:n.address,neighbourhood:n.neighbourhood,borough:n.borough,locality:n.locality,county:n.county,region:n.region,postalcode:n.postalcode,country:n.country,"focus.point.lat":n.focusPointLat,"focus.point.lon":n.focusPointLon,"boundary.rect.min_lat":n.boundaryRectMinLat,"boundary.rect.max_lat":n.boundaryRectMaxLat,"boundary.rect.min_lon":n.boundaryRectMinLon,"boundary.rect.max_lon":n.boundaryRectMaxLon,"boundary.circle.lat":n.boundaryCircleLat,"boundary.circle.lon":n.boundaryCircleLon,"boundary.circle.radius":n.boundaryCircleRadius,"boundary.country":n.boundaryCountry,"boundary.gid":n.boundaryGid,layers:n.layers==null?void 0:n.layers.map(T),sources:n.sources==null?void 0:n.sources.map(C),size:n.size,lang:n.lang}}function tn(n){return on(n,!1)}function on(n,o=!1){return n==null||typeof n!="object"?n:W(n)?X(n):Y(n)}function en(n){return an(n,!1)}function an(n,o=!1){return n==null?n:{endpoint:n.endpoint,query:tn(n.query)}}function rn(n){return sn(n)}function sn(n,o){return n==null?n:{attribution:n.attribution==null?void 0:n.attribution,query:n.query==null?void 0:n.query,warnings:n.warnings==null?void 0:n.warnings,errors:n.errors==null?void 0:n.errors}}function ln(n){return un(n)}function un(n,o){return n==null?n:{type:n.type,coordinates:n.coordinates}}function cn(n){return dn(n)}function dn(n,o){return n==null?n:{...n,website:n.website==null?void 0:n.website,wikipedia:n.wikipedia==null?void 0:n.wikipedia,wikidata:n.wikidata==null?void 0:n.wikidata,phone:n.phone==null?void 0:n.phone}}function hn(n){return pn(n)}function pn(n,o){return n==null?n:{...n,osm:n.osm==null?void 0:cn(n.osm)}}function yn(n){return gn(n)}function gn(n,o){return n==null?n:{...n,gid:n.gid==null?void 0:n.gid,sourceId:n.source_id==null?void 0:n.source_id,label:n.label==null?void 0:n.label,layer:n.layer==null?void 0:n.layer,source:n.source==null?void 0:n.source,name:n.name==null?void 0:n.name,accuracy:n.accuracy==null?void 0:n.accuracy,addendum:n.addendum==null?void 0:hn(n.addendum),continent:n.continent==null?void 0:n.continent,continentGid:n.continent_gid==null?void 0:n.continent_gid,country:n.country==null?void 0:n.country,countryA:n.country_a==null?void 0:n.country_a,countryCode:n.country_code==null?void 0:n.country_code,countryGid:n.country_gid==null?void 0:n.country_gid,neighbourhood:n.neighbourhood==null?void 0:n.neighbourhood,neighbourhoodGid:n.neighbourhood_gid==null?void 0:n.neighbourhood_gid,borough:n.borough==null?void 0:n.borough,boroughGid:n.borough_gid==null?void 0:n.borough_gid,postalcode:n.postalcode==null?void 0:n.postalcode,street:n.street==null?void 0:n.street,housenumber:n.housenumber==null?void 0:n.housenumber,locality:n.locality==null?void 0:n.locality,localityGid:n.locality_gid==null?void 0:n.locality_gid,county:n.county==null?void 0:n.county,countyGid:n.county_gid==null?void 0:n.county_gid,region:n.region==null?void 0:n.region,regionA:n.region_a==null?void 0:n.region_a,regionGid:n.region_gid==null?void 0:n.region_gid,localadmin:n.localadmin==null?void 0:n.localadmin,localadminGid:n.localadmin_gid==null?void 0:n.localadmin_gid,matchType:n.match_type==null?void 0:n.match_type,confidence:n.confidence==null?void 0:n.confidence}}function bn(n){return mn(n)}function mn(n,o){return n==null?n:{type:n.type,geometry:ln(n.geometry),properties:n.properties==null?void 0:yn(n.properties),bbox:n.bbox==null?void 0:n.bbox}}function w(n){return vn(n)}function vn(n,o){return n==null?n:{geocoding:rn(n.geocoding),bbox:n.bbox==null?void 0:n.bbox,features:n.features.map(bn)}}function fn(n){return wn(n)}function wn(n,o){return n==null?n:{status:n.status,response:n.response==null?void 0:w(n.response),msg:n.msg==null?void 0:n.msg}}function h(n){return xn(n)}function xn(n,o){return n==null?n:{abbreviation:n.abbreviation==null?void 0:n.abbreviation,gid:n.gid,name:n.name}}function _n(n){return qn(n)}function qn(n,o){return n==null?n:{borough:n.borough==null?void 0:h(n.borough),continent:n.continent==null?void 0:h(n.continent),country:n.country==null?void 0:h(n.country),county:n.county==null?void 0:h(n.county),dependency:n.dependency==null?void 0:h(n.dependency),localadmin:n.localadmin==null?void 0:h(n.localadmin),locality:n.locality==null?void 0:h(n.locality),macrocounty:n.macrocounty==null?void 0:h(n.macrocounty),macroregion:n.macroregion==null?void 0:h(n.macroregion),marinearea:n.marinearea==null?void 0:h(n.marinearea),neighbourhood:n.neighbourhood==null?void 0:h(n.neighbourhood),ocean:n.ocean==null?void 0:h(n.ocean),region:n.region==null?void 0:h(n.region)}}function Ln(n){return Rn(n)}function Rn(n,o){return n==null?n:{iso3166A2:n.iso_3166_a2==null?void 0:n.iso_3166_a2,iso3166A3:n.iso_3166_a3==null?void 0:n.iso_3166_a3,whosonfirst:_n(n.whosonfirst)}}function Cn(n){return Tn(n)}function Tn(n,o){return n==null?n:{coordinates:n.coordinates,type:n.type}}function Mn(n){return kn(n)}function kn(n,o){return n}function Sn(n){return In(n)}function In(n,o){return n==null?n:{fixitUrl:n.fixit_url==null?void 0:n.fixit_url,source:n.source,sourceId:n.source_id}}function Pn(n){return En(n)}function En(n,o){return n}function Gn(n){return Zn(n)}function Zn(n,o){return n==null?n:{addendum:n.addendum==null?void 0:H(n.addendum),addressComponents:n.address_components==null?void 0:U(n.address_components),coarseLocation:n.coarse_location==null?void 0:n.coarse_location,confidence:n.confidence==null?void 0:n.confidence,context:n.context==null?void 0:Ln(n.context),distance:n.distance==null?void 0:n.distance,formattedAddressLine:n.formatted_address_line==null?void 0:n.formatted_address_line,formattedAddressLines:n.formatted_address_lines==null?void 0:n.formatted_address_lines,gid:n.gid,layer:n.layer,matchType:n.match_type==null?void 0:Mn(n.match_type),name:n.name,precision:Pn(n.precision),sources:n.sources==null?void 0:n.sources.map(Sn)}}function An(n){return jn(n)}function jn(n,o){return n==null?n:{bbox:n.bbox==null?void 0:n.bbox,geometry:n.geometry==null?void 0:Cn(n.geometry),properties:Gn(n.properties),type:n.type==null?void 0:n.type}}function zn(n){return Fn(n)}function Fn(n,o){return n==null?n:{attribution:n.attribution,error:n.error==null?void 0:n.error,query:n.query==null?void 0:n.query}}function x(n){return Dn(n)}function Dn(n,o){return n==null?n:{bbox:n.bbox==null?void 0:n.bbox,features:n.features.map(An),geocoding:zn(n.geocoding),type:n.type}}let On=class extends E{async autocompleteRaw(n,o){if(n.text==null)throw new p("text",'Required parameter "text" was null or undefined when calling autocomplete().');const t={};n.text!=null&&(t.text=n.text),n.focusPointLat!=null&&(t["focus.point.lat"]=n.focusPointLat),n.focusPointLon!=null&&(t["focus.point.lon"]=n.focusPointLon),n.boundaryRectMinLat!=null&&(t["boundary.rect.min_lat"]=n.boundaryRectMinLat),n.boundaryRectMaxLat!=null&&(t["boundary.rect.max_lat"]=n.boundaryRectMaxLat),n.boundaryRectMinLon!=null&&(t["boundary.rect.min_lon"]=n.boundaryRectMinLon),n.boundaryRectMaxLon!=null&&(t["boundary.rect.max_lon"]=n.boundaryRectMaxLon),n.boundaryCircleLat!=null&&(t["boundary.circle.lat"]=n.boundaryCircleLat),n.boundaryCircleLon!=null&&(t["boundary.circle.lon"]=n.boundaryCircleLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/autocomplete",method:"GET",headers:e,query:t},o);return new y(a,r=>w(r))}async autocomplete(n,o){return await(await this.autocompleteRaw(n,o)).value()}async autocompleteV2Raw(n,o){if(n.text==null)throw new p("text",'Required parameter "text" was null or undefined when calling autocompleteV2().');const t={};n.text!=null&&(t.text=n.text),n.focusPointLat!=null&&(t["focus.point.lat"]=n.focusPointLat),n.focusPointLon!=null&&(t["focus.point.lon"]=n.focusPointLon),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryRectMinLat!=null&&(t["boundary.rect.min_lat"]=n.boundaryRectMinLat),n.boundaryRectMinLon!=null&&(t["boundary.rect.min_lon"]=n.boundaryRectMinLon),n.boundaryRectMaxLat!=null&&(t["boundary.rect.max_lat"]=n.boundaryRectMaxLat),n.boundaryRectMaxLon!=null&&(t["boundary.rect.max_lon"]=n.boundaryRectMaxLon),n.boundaryCircleLat!=null&&(t["boundary.circle.lat"]=n.boundaryCircleLat),n.boundaryCircleLon!=null&&(t["boundary.circle.lon"]=n.boundaryCircleLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v2/autocomplete",method:"GET",headers:e,query:t},o);return new y(a,r=>x(r))}async autocompleteV2(n,o){return await(await this.autocompleteV2Raw(n,o)).value()}async placeDetailsRaw(n,o){if(n.ids==null)throw new p("ids",'Required parameter "ids" was null or undefined when calling placeDetails().');const t={};n.ids!=null&&(t.ids=n.ids.join(l.csv)),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/place",method:"GET",headers:e,query:t},o);return new y(a,r=>w(r))}async placeDetails(n,o){return await(await this.placeDetailsRaw(n,o)).value()}async placeDetailsV2Raw(n,o){if(n.ids==null)throw new p("ids",'Required parameter "ids" was null or undefined when calling placeDetailsV2().');const t={};n.ids!=null&&(t.ids=n.ids.join(l.csv)),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v2/place_details",method:"GET",headers:e,query:t},o);return new y(a,r=>x(r))}async placeDetailsV2(n,o){return await(await this.placeDetailsV2Raw(n,o)).value()}async reverseRaw(n,o){if(n.pointLat==null)throw new p("pointLat",'Required parameter "pointLat" was null or undefined when calling reverse().');if(n.pointLon==null)throw new p("pointLon",'Required parameter "pointLon" was null or undefined when calling reverse().');const t={};n.pointLat!=null&&(t["point.lat"]=n.pointLat),n.pointLon!=null&&(t["point.lon"]=n.pointLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/reverse",method:"GET",headers:e,query:t},o);return new y(a,r=>w(r))}async reverse(n,o){return await(await this.reverseRaw(n,o)).value()}async reverseV2Raw(n,o){if(n.pointLat==null)throw new p("pointLat",'Required parameter "pointLat" was null or undefined when calling reverseV2().');if(n.pointLon==null)throw new p("pointLon",'Required parameter "pointLon" was null or undefined when calling reverseV2().');const t={};n.pointLat!=null&&(t["point.lat"]=n.pointLat),n.pointLon!=null&&(t["point.lon"]=n.pointLon),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v2/reverse",method:"GET",headers:e,query:t},o);return new y(a,r=>x(r))}async reverseV2(n,o){return await(await this.reverseV2Raw(n,o)).value()}async searchRaw(n,o){if(n.text==null)throw new p("text",'Required parameter "text" was null or undefined when calling search().');const t={};n.text!=null&&(t.text=n.text),n.focusPointLat!=null&&(t["focus.point.lat"]=n.focusPointLat),n.focusPointLon!=null&&(t["focus.point.lon"]=n.focusPointLon),n.boundaryRectMinLat!=null&&(t["boundary.rect.min_lat"]=n.boundaryRectMinLat),n.boundaryRectMaxLat!=null&&(t["boundary.rect.max_lat"]=n.boundaryRectMaxLat),n.boundaryRectMinLon!=null&&(t["boundary.rect.min_lon"]=n.boundaryRectMinLon),n.boundaryRectMaxLon!=null&&(t["boundary.rect.max_lon"]=n.boundaryRectMaxLon),n.boundaryCircleLat!=null&&(t["boundary.circle.lat"]=n.boundaryCircleLat),n.boundaryCircleLon!=null&&(t["boundary.circle.lon"]=n.boundaryCircleLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search",method:"GET",headers:e,query:t},o);return new y(a,r=>w(r))}async search(n,o){return await(await this.searchRaw(n,o)).value()}async searchBulkRaw(n,o){const t={},e={};e["Content-Type"]="application/json",this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search/bulk",method:"POST",headers:e,query:t,body:n.bulkRequest.map(en)},o);return new y(a,r=>r.map(fn))}async searchBulk(n={},o){return await(await this.searchBulkRaw(n,o)).value()}async searchStructuredRaw(n,o){const t={};n.address!=null&&(t.address=n.address),n.neighbourhood!=null&&(t.neighbourhood=n.neighbourhood),n.borough!=null&&(t.borough=n.borough),n.locality!=null&&(t.locality=n.locality),n.county!=null&&(t.county=n.county),n.region!=null&&(t.region=n.region),n.postalcode!=null&&(t.postalcode=n.postalcode),n.country!=null&&(t.country=n.country),n.focusPointLat!=null&&(t["focus.point.lat"]=n.focusPointLat),n.focusPointLon!=null&&(t["focus.point.lon"]=n.focusPointLon),n.boundaryRectMinLat!=null&&(t["boundary.rect.min_lat"]=n.boundaryRectMinLat),n.boundaryRectMaxLat!=null&&(t["boundary.rect.max_lat"]=n.boundaryRectMaxLat),n.boundaryRectMinLon!=null&&(t["boundary.rect.min_lon"]=n.boundaryRectMinLon),n.boundaryRectMaxLon!=null&&(t["boundary.rect.max_lon"]=n.boundaryRectMaxLon),n.boundaryCircleLat!=null&&(t["boundary.circle.lat"]=n.boundaryCircleLat),n.boundaryCircleLon!=null&&(t["boundary.circle.lon"]=n.boundaryCircleLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search/structured",method:"GET",headers:e,query:t},o);return new y(a,r=>w(r))}async searchStructured(n={},o){return await(await this.searchStructuredRaw(n,o)).value()}async searchV2Raw(n,o){if(n.text==null)throw new p("text",'Required parameter "text" was null or undefined when calling searchV2().');const t={};n.text!=null&&(t.text=n.text),n.focusPointLat!=null&&(t["focus.point.lat"]=n.focusPointLat),n.focusPointLon!=null&&(t["focus.point.lon"]=n.focusPointLon),n.layers!=null&&(t.layers=n.layers.join(l.csv)),n.sources!=null&&(t.sources=n.sources.join(l.csv)),n.boundaryGid!=null&&(t["boundary.gid"]=n.boundaryGid),n.boundaryCountry!=null&&(t["boundary.country"]=n.boundaryCountry.join(l.csv)),n.boundaryRectMinLat!=null&&(t["boundary.rect.min_lat"]=n.boundaryRectMinLat),n.boundaryRectMinLon!=null&&(t["boundary.rect.min_lon"]=n.boundaryRectMinLon),n.boundaryRectMaxLat!=null&&(t["boundary.rect.max_lat"]=n.boundaryRectMaxLat),n.boundaryRectMaxLon!=null&&(t["boundary.rect.max_lon"]=n.boundaryRectMaxLon),n.boundaryCircleLat!=null&&(t["boundary.circle.lat"]=n.boundaryCircleLat),n.boundaryCircleLon!=null&&(t["boundary.circle.lon"]=n.boundaryCircleLon),n.boundaryCircleRadius!=null&&(t["boundary.circle.radius"]=n.boundaryCircleRadius),n.size!=null&&(t.size=n.size),n.lang!=null&&(t.lang=n.lang);const e={};this.configuration&&this.configuration.apiKey&&(t.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v2/search",method:"GET",headers:e,query:t},o);return new y(a,r=>x(r))}async searchV2(n,o){return await(await this.searchV2Raw(n,o)).value()}};class Kn extends On{constructor(){super(...arguments),this.cache=new Map}async autocomplete(o,t){let e=t===null?"null":typeof t=="function"?t.toString():JSON.stringify(t);const a=JSON.stringify(o)+e;if(this.cache.has(a))return this.cache.get(a);let r=await super.autocomplete(o,t);if(this.cache.size>=20){const s=this.cache.keys().next().value;this.cache.delete(s)}return this.cache.set(a,r),r}}const Bn="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2019.1.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20176.179%20172.152'%20style='enable-background:new%200%200%20176.179%20172.152;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23333333;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M89.244,97.036c4.036-18.534,11.259-25.237,15.416-34.469l0.043-0.099c1.039-2.2,1.533-4.543,1.533-7.141%20c0-9.388-7.621-16.975-17.044-16.975s-16.975,7.587-16.975,16.975c0,2.598,0.554,5.023,1.594,7.223%20c4.122,9.25,11.328,15.936,15.381,34.469L89.244,97.036z%20M84.463,50.494c0-2.631,2.133-4.763,4.763-4.763%20c2.631,0,4.763,2.133,4.763,4.763c0,2.631-2.133,4.763-4.763,4.763C86.596,55.257,84.463,53.124,84.463,50.494z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M37.081,94.068l-13.488,10.967c-3.591,2.92-3.446,6.533,0.388,8.047l43.014,16.991l20.175-17.865%20L37.081,94.068z%20M66.497,126.347L26.73,110.822c-2.237-0.873-2.341-2.974-0.254-4.68l10.858-8.872l43.913,16.089L66.497,126.347z'%20/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M70.289,131.375l17.082,6.747c4.585,1.811,11.33,0.53,14.956-2.846l13.59-12.656l-25.449-9.217%20L70.289,131.375z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M91.374,98.976c-0.208,1.005-1.109,1.732-2.13,1.732v-0.017c-1.039,0-1.905-0.693-2.148-1.732%20c-1.148-5.242-2.552-9.616-4.07-13.432l-18.171,15.416l53.697,19.223l20.073-18.694L94.798,87.135%20C93.524,90.567,92.351,94.445,91.374,98.976z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M150.796,79.922L108.039,67.22c0.427-0.848,0.842-1.702,1.228-2.575l0.173-0.346%20c1.264-2.858,1.905-5.855,1.905-8.972c0-12.194-9.925-22.119-22.137-22.119c-12.194,0-22.102,9.925-22.119,22.119%20c0,3.256,0.693,6.426,2.079,9.319c0.369,0.815,0.759,1.607,1.157,2.392l-30.623,24.9l22.086,7.906l20.126-16.985%20c-1.885-4.287-3.888-7.854-5.765-11.198c-1.136-2.02-2.23-3.989-3.236-5.979c-0.376-0.74-0.751-1.48-1.094-2.231%20c-1.161-2.529-1.767-5.3-1.767-8.141c0-10.566,8.574-19.157,19.157-19.157c10.601,0,19.227,8.591,19.227,19.175%20c0,2.737-0.676,5.595-1.819,8.124c-0.52,1.188-1.102,2.354-1.716,3.518c-0.817,1.551-1.695,3.099-2.615,4.692%20c-0.361,0.644-0.728,1.299-1.097,1.963c-0.027,0.049-0.054,0.096-0.081,0.145l0.001-0.001c-1.384,2.494-2.804,5.161-4.172,8.179%20l-0.004-0.001c-0.029,0.064-0.057,0.133-0.085,0.197c-0.067,0.15-0.136,0.294-0.203,0.446l0.008,0.003%20c-0.279,0.629-0.559,1.258-0.833,1.921l45.29,14.646l12.311-11.465C156.571,84.76,155.362,81.278,150.796,79.922z%20M149.922,86.624%20l-9.847,9.114L99.773,82.853c1.676-3.654,3.424-6.805,5.077-9.755c0.67-1.188,1.318-2.348,1.947-3.508l41.627,12.507%20C151.077,82.895,151.759,84.924,149.922,86.624z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",M="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000'%3e%3cpath%20d='M480-480q33%200%2056.5-23.5T560-560q0-33-23.5-56.5T480-640q-33%200-56.5%2023.5T400-560q0%2033%2023.5%2056.5T480-480Zm0%20294q122-112%20181-203.5T720-552q0-109-69.5-178.5T480-800q-101%200-170.5%2069.5T240-552q0%2071%2059%20162.5T480-186Zm0%20106Q319-217%20239.5-334.5T160-552q0-150%2096.5-239T480-880q127%200%20223.5%2089T800-552q0%20100-79.5%20217.5T480-80Zm0-480Z'/%3e%3c/svg%3e",Nn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000'%3e%3cpath%20d='M220-360v-180h-60v-60h120v240h-60Zm140%200v-100q0-17%2011.5-28.5T400-500h80v-40H360v-60h140q17%200%2028.5%2011.5T540-560v60q0%2017-11.5%2028.5T500-460h-80v40h120v60H360Zm240%200v-60h120v-40h-80v-40h80v-40H600v-60h140q17%200%2028.5%2011.5T780-560v160q0%2017-11.5%2028.5T740-360H600Z'/%3e%3c/svg%3e",Vn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M160-160v-640h80v640h-80Zm280%200v-160h80v160h-80Zm280%200v-640h80v640h-80ZM440-400v-160h80v160h-80Zm0-240v-160h80v160h-80Z'/%3e%3c/svg%3e",Hn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M640-200v80q0%2017-11.5%2028.5T600-80H120q-17%200-28.5-11.5T80-120v-320q0-17%2011.5-28.5T120-480h120v-160q0-100%2070-170t170-70h160q100%200%20170%2070t70%20170v560h-80v-120H640Zm0-80h160v-360q0-66-47-113t-113-47H480q-66%200-113%2047t-47%20113v160h280q17%200%2028.5%2011.5T640-440v160ZM400-560v-80h320v80H400Zm-40%20274%20200-114H160l200%20114Zm0%2070L160-330v170h400v-170L360-216ZM160-400v240-240Z'/%3e%3c/svg%3e",$n="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M480-160q18%200%2034.5-2t33.5-6l-48-72H360v-40q0-33%2023.5-56.5T440-360h80v-120h-80q-17%200-28.5-11.5T400-520v-80h-18q-26%200-44-17.5T320-661q0-9%202.5-18t7.5-17l62-91q-101%2029-166.5%20113T160-480h40v-40q0-17%2011.5-28.5T240-560h80q17%200%2028.5%2011.5T360-520v40q0%2017-11.5%2028.5T320-440v40q0%2033-23.5%2056.5T240-320h-37q42%2072%20115%20116t162%2044Zm304-222q8-23%2012-47.5t4-50.5q0-112-68-197.5T560-790v110q33%200%2056.5%2023.5T640-600v80q19%200%2034%204.5t29%2018.5l81%20115ZM480-80q-83%200-156-31.5T197-197q-54-54-85.5-127T80-480q0-83%2031.5-156T197-763q54-54%20127-85.5T480-880q83%200%20156%2031.5T763-763q54%2054%2085.5%20127T880-480q0%2083-31.5%20156T763-197q-54%2054-127%2085.5T480-80Z'/%3e%3c/svg%3e",Un="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M480-80q-82%200-155-31.5t-127.5-86Q143-252%20111.5-325T80-480q0-83%2031.5-155.5t86-127Q252-817%20325-848.5T480-880q83%200%20155.5%2031.5t127%2086q54.5%2054.5%2086%20127T880-480q0%2082-31.5%20155t-86%20127.5q-54.5%2054.5-127%2086T480-80Zm0-82q26-36%2045-75t31-83H404q12%2044%2031%2083t45%2075Zm-104-16q-18-33-31.5-68.5T322-320H204q29%2050%2072.5%2087t99.5%2055Zm208%200q56-18%2099.5-55t72.5-87H638q-9%2038-22.5%2073.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21%201.5-40.5T306-560H170q-5%2020-7.5%2039.5T160-480q0%2021%202.5%2040.5T170-400Zm216%200h188q3-20%204.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3%2020-4.5%2039.5T380-480q0%2021%201.5%2040.5T386-400Zm268%200h136q5-20%207.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3%2020%204.5%2039.5T660-480q0%2021-1.5%2040.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18%2033%2031.5%2068.5T638-640Zm-234%200h152q-12-44-31-83t-45-75q-26%2036-45%2075t-31%2083Zm-200%200h118q9-38%2022.5-73.5T376-782q-56%2018-99.5%2055T204-640Z'/%3e%3c/svg%3e",Jn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M120-120v-560h240v-80l120-120%20120%20120v240h240v400H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240%20320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240%20480h80v-80h-80v80Zm0-160h80v-80h-80v80Z'/%3e%3c/svg%3e",Wn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M80-240v-80q38%200%2056.5-20t77.5-20q59%200%2077.5%2020t54.5%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020q38%200%2055.5-20t76.5-20q59%200%2077.5%2020t56.5%2020v80q-57%200-77.5-20T746-280q-36%200-54.5%2020T614-240q-57%200-77.5-20T480-280q-38%200-56.5%2020T346-240q-59%200-76.5-20T214-280q-38%200-56.5%2020T80-240Zm0-160v-80q38%200%2056.5-20t77.5-20q57%200%2076.5%2020t55.5%2020q38%200%2056.5-20t77.5-20q57%200%2077%2020t55%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020v80q-59%200-78.5-20T746-440q-36%200-54.5%2020T614-400q-57%200-77.5-20T480-440q-38%200-55.5%2020T348-400q-59%200-78.5-20T214-440q-36%200-56.5%2020T80-400Zm0-160v-80q38%200%2056.5-20t77.5-20q57%200%2076.5%2020t55.5%2020q38%200%2056.5-20t77.5-20q57%200%2077%2020t55%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020v80q-59%200-78.5-20T746-600q-36%200-54.5%2020T614-560q-57%200-77.5-20T480-600q-38%200-55.5%2020T348-560q-59%200-78.5-20T214-600q-36%200-56.5%2020T80-560Z'/%3e%3c/svg%3e";class _{constructor(){i(this,"useMapFocusPoint",!0);i(this,"mapFocusPointMinZoom",5);i(this,"fixedFocusPoint",null);i(this,"searchOnEnter",!0);i(this,"maxResults",5);i(this,"minInputLength",3);i(this,"minWaitPeriodMs",100);i(this,"layers",null);i(this,"onResultSelected");i(this,"baseUrl",null)}}class Xn{constructor(o={}){i(this,"map",null);i(this,"container",null);i(this,"resultsContainer",null);i(this,"resultsList",null);i(this,"input",null);i(this,"clearButton",null);i(this,"loadingSpinner",null);i(this,"api");i(this,"lastRequestAt",0);i(this,"lastRequestString","");i(this,"resultFeatures",[]);i(this,"selectedResultIndex",null);i(this,"originalInput","");i(this,"CLASS_PREFIX","maplibre-search-box");i(this,"LOADING_CLASS",`${this.CLASS_PREFIX}-loading`);i(this,"options",new _);this.options=Object.assign(new _,o),this.api=new Kn(new v({basePath:o.baseUrl}))}onAdd(o){return this.map=o,this.container=this.buildInput(),this.container}buildInput(){const o=document.createElement("div");o.className=`maplibregl-ctrl ${this.CLASS_PREFIX}`;const t=o.appendChild(document.createElement("div"));t.className="input-container",this.clearButton=t.appendChild(document.createElement("span")),this.clearButton.className="cancel hidden",this.clearButton.addEventListener("click",this.onClear.bind(this)),this.loadingSpinner=t.appendChild(document.createElement("span")),this.loadingSpinner.className="spinner lds-dual-ring hidden",this.input=t.appendChild(document.createElement("input")),this.input.type="text",this.input.placeholder="Search for places...",this.input.addEventListener("input",this.onInput.bind(this)),this.input.addEventListener("focus",this.onFocus.bind(this)),this.input.addEventListener("keydown",this.onKey.bind(this)),this.input.enterKeyHint="search",this.resultsContainer=o.appendChild(document.createElement("div")),this.resultsContainer.className="results hidden",this.resultsList=this.resultsContainer.appendChild(document.createElement("div")),this.resultsList.className="results-list";const e=this.resultsContainer.appendChild(document.createElement("div"));return e.className="search-attribution",e.innerHTML=`<img height="50" width="50" src="${Bn}" alt="Stadia Maps" class="logo"> Powered by <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a><br>&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="nofollow">OpenStreetMap</a> contributors &amp; <a href="https://stadiamaps.com/attribution/" target="_blank">others</a>`,o}getContainer(){return this.container}async onFocus(o){this.resultFeatures.length>0&&this.showResults(),this.maybeShowClearButton()}maybeShowClearButton(){const o=this.input.value.length>0;this.clearButton.classList.toggle("hidden",!o)}async onKey(o){switch(o.key){case"Enter":this.selectedResultIndex!==null?(await this.onSelected(this.resultFeatures[this.selectedResultIndex]),this.input.blur()):this.options.searchOnEnter&&await this.onInput(o,!0);break;case"Escape":this.onClear();break;case"ArrowDown":case"ArrowUp":o.preventDefault(),this.handleArrowKey(o.key);break}}handleArrowKey(o){o==="ArrowDown"?this.selectedResultIndex===null?(this.selectedResultIndex=0,this.originalInput=this.input.value):this.selectedResultIndex<this.resultFeatures.length-1&&this.selectedResultIndex++:o==="ArrowUp"&&(this.selectedResultIndex>0?this.selectedResultIndex--:this.selectedResultIndex===0&&(this.selectedResultIndex=null,this.input.value=this.originalInput)),this.updateSelectedResult()}updateSelectedResult(){Array.from(this.resultsList.children).forEach((t,e)=>{e===this.selectedResultIndex?(t.classList.add("hover"),this.input.value=this.resultFeatures[e].properties.name):t.classList.remove("hover")})}async onInput(o,t=!1){var r;this.maybeShowClearButton();const e=this.input.value;if(!e){this.clearResults(),this.hideResults();return}const a=Date.now().valueOf()-this.lastRequestAt;if(this.lastRequestAt===0||a>=this.options.minWaitPeriodMs){if(e.length>=this.options.minInputLength&&(e!==this.lastRequestString||t)){const s={text:e,size:this.options.maxResults};this.options.layers&&(s.layers=this.options.layers);let u=this.options.fixedFocusPoint;this.options.useMapFocusPoint&&this.map.getZoom()>=this.options.mapFocusPointMinZoom&&(u=this.map.getCenter().toArray()),u&&(s.focusPointLon=u[0],s.focusPointLat=u[1]),this.options.layers&&(s.layers=this.options.layers),this.lastRequestString=e;const m=Date.now().valueOf();this.lastRequestAt=m,this.container.classList.toggle(this.LOADING_CLASS,!0);try{let f;if(t){let g={text:s.text};Object.assign(g,s),g.layers=(r=s.layers)==null?void 0:r.map(S=>{switch(S){case"poi":return"venue";default:return S}}),f=(await this.api.search(g)).features.map(Yn)}else f=(await this.api.autocompleteV2(s)).features;if(this.lastRequestAt===m)if(this.clearResults(),this.resultFeatures=f,this.resultFeatures.length>0)for(const g of this.resultFeatures)this.addResult(g);else this.onNoResults()}catch(f){console.warn(`Something when wrong with the request: ${f}`)}finally{this.lastRequestAt===m&&this.container.classList.toggle(this.LOADING_CLASS,!1)}}}else setTimeout(()=>{this.onInput(o,t)},this.options.minWaitPeriodMs)}onNoResults(){this.showResults();const o=document.createElement("div");o.className="result no-result",o.textContent="No Results Found",this.resultsList.appendChild(o)}async onSelected(o){if(Qn(o))if(o.bbox!==void 0)this.map.fitBounds([[o.bbox[0],o.bbox[1]],[o.bbox[2],o.bbox[3]]]);else{let t;switch(o.properties.layer){case"venue":case"poi":case"address":t=16;break;case"marinearea":case"locality":t=12;break;case"empire":case"macrocounty":case"country":t=4;break;case"dependency":case"county":t=10;break;case"continent":case"ocean":t=2;break;case"macroregion":case"region":t=7;break;case"borough":case"localadmin":t=12;break;case"macrohood":case"postalcode":case"neighbourhood":case"street":t=14;break;default:t=10}this.map.flyTo({center:[o.geometry.coordinates[0],o.geometry.coordinates[1]],zoom:t})}else{const t=await this.api.placeDetailsV2({ids:[o.properties.gid]});t.features.length==0&&console.error("Unexpected place lookup response with zero results"),await this.onSelected(t.features[0])}this.hideResults(),this.options.onResultSelected&&this.options.onResultSelected(o)}onClear(){this.input.value="",this.maybeShowClearButton(),this.clearResults(),this.hideResults(),this.input.focus()}icon(o){switch(o){case"venue":case"poi":return M;case"address":return Nn;case"street":return Vn;case"postalcode":return Hn;case"localadmin":case"locality":case"borough":case"neighbourhood":case"macrohood":case"coarse":return Jn;case"county":case"macroregion":case"macrocounty":case"region":case"country":case"dependency":case"disputed":return $n;case"empire":case"continent":return Un;case"marinearea":case"ocean":return Wn;default:return M}}buildResult(o){const t=document.createElement("div");t.className="result",t.onclick=async()=>{this.selectedResultIndex=this.resultFeatures.indexOf(o),this.updateSelectedResult(),await this.onSelected(o)},t.title=o.properties.name;const e=t.appendChild(document.createElement("img"));e.src=this.icon(o.properties.layer),e.className="result-icon";const a=t.appendChild(document.createElement("div"));a.textContent=o.properties.name,a.className="result-label";const r=t.appendChild(document.createElement("div"));return r.className="result-extra",r.textContent=o.properties.coarseLocation||k(o.properties),t}addResult(o){this.showResults(),this.resultsList.appendChild(this.buildResult(o))}hideResults(){this.resultsContainer.classList.toggle("hidden",!0)}showResults(){this.resultsContainer.classList.toggle("hidden",!1)}clearResults(){this.resultFeatures=[],this.resultsList.replaceChildren(""),this.selectedResultIndex=null,this.originalInput=""}onRemove(o){var t,e;o._container&&((e=(t=this.container)==null?void 0:t.parentNode)==null||e.removeChild(this.container)),this.container=null,this.map=null}}function Qn(n){return n.geometry!==null&&n.geometry!==void 0}function k(n){let o=[];switch(n.layer){case"venue":case"address":case"street":case"neighbourhood":case"postalcode":case"macrohood":o=[n.locality??n.region,n.country];break;case"country":case"dependency":case"disputed":o=[n.continent];break;case"macroregion":case"region":o=[n.country];break;case"macrocounty":case"county":case"locality":case"localadmin":case"borough":o=[n.region,n.country];break}return o.filter(t=>t!=null).join(", ")}function Yn(n){return{type:"Feature",bbox:n.bbox,geometry:n.geometry,properties:{addendum:n.properties.addendum,addressComponents:{number:n.properties.housenumber,street:n.properties.street,postalCode:n.properties.postalcode},coarseLocation:k(n.properties),confidence:n.properties.confidence,context:{whosonfirst:{borough:b(n.properties,"borough"),continent:b(n.properties,"continent"),country:b(n.properties,"country"),county:b(n.properties,"county"),localadmin:b(n.properties,"localadmin"),locality:b(n.properties,"locality"),neighbourhood:b(n.properties,"neighbourhood"),region:b(n.properties,"region")},iso3166A2:n.properties.countryCode,iso3166A3:n.properties.countryA},gid:n.properties.gid,layer:n.properties.layer==="venue"?"poi":n.properties.layer,name:n.properties.name,precision:n.properties.accuracy,sources:[{source:n.properties.source,sourceId:n.properties.sourceId}]}}}function b(n,o){if(n[o]&&n[`${o}GID`])return{name:n[o],gid:n[`${o}GID`],abbreviation:n[`${o}A`]}}c.MapLibreSearchControl=Xn,c.MapLibreSearchControlOptions=_,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=maplibre-search-box.umd.js.map
